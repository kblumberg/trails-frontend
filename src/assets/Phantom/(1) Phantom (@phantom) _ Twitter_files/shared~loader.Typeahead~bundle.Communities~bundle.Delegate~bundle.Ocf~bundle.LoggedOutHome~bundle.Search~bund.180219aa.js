"use strict";(self.webpackChunk_twitter_responsive_web=self.webpackChunk_twitter_responsive_web||[]).push([["shared~loader.Typeahead~bundle.Communities~bundle.Delegate~bundle.Ocf~bundle.LoggedOutHome~bundle.Search~bund"],{99322:(e,t,s)=>{s.d(t,{Z:()=>n});s(2784);var i=s(90601);const o=s(73186).Z.create({initial:{alignItems:"stretch",borderWidth:0,borderStyle:"solid",boxSizing:"border-box",display:"flex",flexDirection:"column",margin:0,padding:0,position:"relative",zIndex:0,minHeight:0,minWidth:0}}),n=e=>{const{style:t,...s}=e;return(0,i.Z)("form",{...s,action:"#",style:[o.initial,t]})}},36830:(e,t,s)=>{s.d(t,{Z:()=>I});var i=s(2784),o=s(28316),n=s(25686),r=s(23162),a=s(79640),l=s(16587),d=s(19051),c=s(40159),h=(s(6886),s(5252)),u=s(73186),p=s(73228),m=s.n(p),f=s(37378);const y=m().f2b3fe06,g=u.Z.create((e=>({hidden:{visibility:"hidden"}}))),_=({isLoading:e})=>{const[t,s]=i.useState(!1);return i.useEffect((()=>{let t;return e?t=setTimeout((()=>s(!0)),f.n):s(!1),()=>clearTimeout(t)}),[e]),i.createElement(h.Z,{ariaValueText:t?y:"",indeterminate:t,style:!t&&g.hidden})};class I extends i.Component{constructor(e,t){super(e),this._setFocusedItemRef=e=>{this._shouldScrollToFocusedItem&&e&&((0,c.up)(this._getScrollParent(),e),this._shouldScrollToFocusedItem=!1)},this._resetScroll=()=>{const e=this._getScrollParent();e&&(e.scrollTop=0)},this._getFlattenedItems=(0,l.Z)((e=>(0,a.Z)(e))),this._handleItemClick=(e,t)=>{const{items:s,onItemClick:i}=this.props,o=this._getFlattenedItems(s).indexOf(e);e&&!t&&!this._shouldBlockInteractivity&&i(e,o),this._resetFocus()},this._getResultCount=()=>{const{items:e}=this.props;return this._getFlattenedItems(e).length},this._setFocusIndex=(e,t)=>{const{items:s,onItemFocusChanged:i}=this.props;this._shouldScrollToFocusedItem=t,this.setState({focusIndex:e}),i&&i(this._getFlattenedItems(s)[e])},this._resetFocus=()=>{this._setFocusIndex(this.props.withItemAlwaysSelected?0:-1)},this.focusNext=()=>{const{focusIndex:e}=this.state,t=this._getResultCount();if(0===t)return;const s=e+1>=t?0:e+1;this._setFocusIndex(s,!0)},this.focusPrevious=()=>{const{focusIndex:e}=this.state,t=this._getResultCount();if(0===t)return;const s=e-1<0?t-1:e-1;this._setFocusIndex(s,!0)},this.hasFocusedItem=()=>{const{focusIndex:e}=this.state,t=this._getResultCount();return e>=0&&t>e},this.selectFocusedItem=()=>{const{focusIndex:e}=this.state,{getItemIsDisabled:t,items:s}=this.props;if(this.hasFocusedItem()){const i=this._getFlattenedItems(s)[e],o=!!t&&t(i,i.data);this._handleItemClick(i,o)}},this.state={focusIndex:e.withItemAlwaysSelected?0:-1}}componentDidMount(){this._resetFocus()}componentWillUnmount(){clearTimeout(this._interactivityTimeout)}componentDidUpdate(e){e.items!==this.props.items&&(this._resetFocus(),this._resetScroll(),this._interactivityTimeout&&clearTimeout(this._interactivityTimeout),this._shouldBlockInteractivity=!0,this._interactivityTimeout=setTimeout((()=>{this._shouldBlockInteractivity=!1}),500))}render(){const{domId:e,isLoading:t,items:s,renderCallout:o,renderHeader:r,renderNoResultsState:a,selectedItems:l,style:d}=this.props,c=!(!t&&!s.length);let h=0;const u=!!l;return c?i.createElement(n.Z,{accessibilityMultiSelectable:u,accessibilityRole:"listbox",nativeID:e,style:d},o?o():null,i.createElement(_,{isLoading:!!t}),r?r():null,s.length?s.map(((e,t)=>{const i=!Array.isArray(s[t-1])&&t>0,o=t<s.length-1,n=Array.isArray(e)?this._renderTypeaheadGroup(e,h,i,o):this._renderTypeaheadItem(e,h);return h+=Array.isArray(e)?e.length:1,n})):null):a?a({style:d}):null}_renderTypeaheadGroup(e,t,s,o){const{withSectionDivider:n}=this.props;return i.createElement(i.Fragment,{key:`typeaheadGroup-${t}`},n&&s?i.createElement(r.Z,{key:`typeaheadDividerTop-${t}`}):null,e.map(((e,s)=>this._renderTypeaheadItem(e,t+s))),n&&o?i.createElement(r.Z,{key:`typeaheadDividerBottom-${t}`}):null)}_renderTypeaheadItem(e,t){const{ariaDescendantId:s,getItemDisabledMessage:o,getItemIsDisabled:n,getUserDisplayNameLabel:r,query:a,renderAvatarDecoration:l,renderUserDecoration:c,selectedItems:h,source:u,withUserHoverCard:p}=this.props,{focusIndex:m}=this.state,f=!(!h||!e.id)&&h.indexOf(e.id)>=0,y=!!h,g=m===t,_=n&&n(e,e.data),I=o&&o(e,e.data);return i.createElement(d.ZP,{disabledMessage:I,domId:g?s:void 0,getUserDisplayNameLabel:r,isDisabled:_,isFocused:g,isInMultiSelect:y,isSelected:f,item:e,key:`typeaheadItem-${t}-${e.id||""}`,onClick:this._handleItemClick,onRef:g?this._setFocusedItemRef:void 0,query:a,renderAvatarDecoration:l,renderUserDecoration:c,source:u,withUserHoverCard:p})}_getScrollParent(){if(!this._scrollParent){const e=(0,c.rP)(o.findDOMNode(this));this._scrollParent=e===window?null:e}return this._scrollParent}}},45102:(e,t,s)=>{s.d(t,{Z:()=>A});var i=s(7896),o=s(2784),n=s(35193),r=s(79640),a=s(36830),l=s(6800),d=s(76275),c=s(88027),h=s(37378),u=s(52612),p=s(23803),m=s(31261),f=(s(36728),s(6886),s(24949)),y=s(11469),g=s(53223),_=s(23335),I=s(32941),w=s(92160),v=s(57851),x=s(41430),b=s(86928),C=s(57659);const D=[c.my.Users],E=e=>{const{communityId:t,filter:s,query:i,source:o,trustedFriendsId:n}=e;return(0,v.Ol)({q:i,result_type:(s||D).join(","),src:o},{communityId:t,trustedFriendsId:n})},R=(e,t)=>{const s=E(t);return(0,v.uD)(e,s)},Z=(e,t)=>{const s=E(t);return(0,v.YN)(e,s)},S=(e,t)=>{const s=E(t);return(0,v.T5)(e,s)},T=(e,t)=>{const s=E(t);return(0,v.dV)(e,s)};function F(e,t){const s=E(t);return(0,v.PG)(e,s)}const P=(e,t)=>(t.rounded_graph_weight||0)-(e.rounded_graph_weight||0);const L=()=>(0,f.P1)(Z,(0,f.P1)(((e,t)=>t.query),((e,t)=>t.filter),x.Sc,x.sM,((e,t,s,i)=>{if(!e||!t||t.indexOf(c.my.Users)<0)return(0,l.o)();const o=(0,x.UA)(s,e);return(0,c.It)(o.map((e=>i[e])).sort(P).slice(0,10))})),R,((e,t)=>t.injectedItems),((e,t)=>t.query),((e,t)=>t.getUserExactMatch),((e,t)=>t.userLimit),((e,t,s,i,o,n,r)=>{const a=(0,y.Z)(i||[],(e=>e.type===c.El.User?e.data.id_str:void 0)),d=t.filter((e=>a.indexOf(e.id)<0)),h=e.filter((e=>a.indexOf(e.id)<0)),u=(0,I.sY)(d,h).slice(0,r||10),m=s===p.ZP.LOADED,f=n&&n({query:o,hasResults:!!e.length,isLoaded:m}),g=f?[...u,f]:u;return{users:g.length?g:(0,l.o)(),userExactMatch:f,filteredPrefetchUsers:d,filteredRemoteUsers:h}})),k=()=>(0,f.P1)((0,f.P1)(T,R,((e,t)=>t.query),((e,t)=>t.maxEvents),((e,t)=>t.filter),((e,t,s,i,o)=>{const n=s&&o&&o.indexOf(c.my.Events)>=0,r=e.slice(0,i||1);return r.length&&n?r:(0,l.o)()})),(0,f.P1)(F,R,((e,t)=>t.query),((e,t)=>t.maxLists),((e,t)=>t.filter),((e,t,s,i,o)=>{const n=s&&o&&o.indexOf(c.my.Lists)>=0,r=e.slice(0,i||3);return r.length&&n?r:(0,l.o)()})),(0,f.P1)(S,R,((e,t)=>t.query),((e,t)=>t.maxTopics),((e,t)=>t.getTopicExactMatch),((e,t,s,i,o)=>{const n=t===p.ZP.LOADED,r=o&&o({query:s,hasResults:!!e.length,isLoaded:n}),a=e.slice(0,i||3);return r&&a.push(r),a.length?a:(0,l.o)()})),L(),((e,t)=>t.injectedItems),((e,t)=>t.orderResults),((e,t,s,i,o,n)=>{const{users:r}=i,a=o&&o.length?o:null,d=n?n(a,e,t,s,r,null==i?void 0:i.filteredRemoteUsers,null==i?void 0:i.filteredPrefetchUsers,null==i?void 0:i.userExactMatch):(0,g.Z)([a,e.length?e:void 0,t.length?t:void 0,s.length?s:void 0,r.length?r:void 0]);return e.length||t.length||s.length||r.length?d:a?[a]:(0,l.o)()})),U=(0,w.Z)().propsFromState((()=>({fetchStatus:R,items:k()}))).propsFromActions((()=>({createLocalApiErrorHandler:(0,_.createLocalApiErrorHandlerWithContextFactory)("TYPEAHEAD_DROPDOWN_CONTAINER_CONTEXT"),fetchTypeaheadIfNeeded:v.o4,fetchUsersIfNeeded:C.ZP.fetchManyIfNeeded,fetchUsersPresenceIfNeeded:b.ZP.fetchManyIfNeeded,prefetchTypeaheadUsersIfNeeded:x.zP}))).withAnalytics({element:"typeahead"});class N extends o.Component{constructor(e,t){super(e,t),this._fetchUsersIfNeeded=(e=[])=>{const{fetchUsersIfNeeded:t,items:s,source:i}=this.props;if(this.context.featureSwitches.isTrue("follow_nudge_search_enabled")&&this.context.loggedInUserId&&i===c._4.SearchBox){const i=(0,r.Z)(e).filter((e=>e.type===u.ZP.User)).map((e=>e.id)),o=(0,r.Z)(s).filter((e=>e.type===u.ZP.User)).filter((e=>!i.includes(e.id))).map((e=>e.id));(null==o?void 0:o.length)&&t(o)}},this._fetchTypeaheadResultsIfNeeded=e=>{const t=this.context.featureSwitches.isTrue("c9s_community_composer_hashtag_suggestions_enabled");e.query&&e.fetchTypeaheadIfNeeded({q:e.query,src:e.source,result_type:e.filter.join(","),context_text:e.contextText,topic_type:e.topicType,context_community_id:t?e.communityId:void 0},{communityId:e.communityId,trustedFriendsId:e.trustedFriendsId}).catch(e.createLocalApiErrorHandler({}))},this._handleItemClick=(e,t)=>{const{analytics:s,onItemClick:i,query:o}=this.props;i(e,t);const n=d.Z.forTypeaheadResult(e,t),r=n?[n]:void 0;s.scribe({action:"click",data:{search_details:{query:o},targets:r}})},this._scribeResults=()=>{const{analytics:e,items:t,query:s}=this.props;e.scribe({action:"impression",data:{items:d.Z.forTypeaheadResults(t),search_details:{query:s}}})},this._debouncedFetchTypeaheadResultsIfNeeded=(0,n.Z)(this._fetchTypeaheadResultsIfNeeded,250),this.state={shouldShowPrefetchResults:!0},this._previouslyLoadedResults=(0,l.o)()}componentDidMount(){const{createLocalApiErrorHandler:e,prefetchTypeaheadUsersIfNeeded:t}=this.props;this._debouncedFetchTypeaheadResultsIfNeeded(this.props),t().catch(e({})),this._fetchUsersIfNeeded()}componentWillUnmount(){clearTimeout(this._prefetchResultsTimer)}componentDidUpdate(e){const{createLocalApiErrorHandler:t,domId:s,fetchUsersPresenceIfNeeded:i,filter:o,items:n,onItemsChanged:a,query:l,shouldDeferPrefetch:d,source:c}=this.props,{filter:m,query:f,source:y}=e,{loggedInUserId:g}=this.context,_=this.context.featureSwitches.isTrue("voice_rooms_typeahead_audiospace_ring_enabled")&&g;if(null!=n&&n.length&&n!==e.items){if(this._scribeResults(),a){let e=!1;const t=s?document.getElementById(s):null;t&&t.scrollHeight>t.offsetHeight&&(e=!0),a(n,e)}if(_){const e=(0,r.Z)(n).filter((e=>e.type===u.ZP.User)).map((e=>e.id));e&&i(e).catch(t({}))}this._fetchUsersIfNeeded(e.items)}e.fetchStatus===p.ZP.LOADED&&(this._previouslyLoadedResults=e.items),l===f&&o===m&&c===y||(this._debouncedFetchTypeaheadResultsIfNeeded(this.props),d&&(clearTimeout(this._prefetchResultsTimer),this.setState({shouldShowPrefetchResults:!1}),this._prefetchResultsTimer=setTimeout((()=>{this.props.query&&this.props.fetchStatus!==p.ZP.LOADED&&this.setState({shouldShowPrefetchResults:!0})}),h.n)))}render(){const{analytics:e,communityId:t,contextText:s,createLocalApiErrorHandler:n,dropdownRef:r,fetchStatus:l,fetchTypeaheadIfNeeded:d,fetchUsersIfNeeded:c,fetchUsersPresenceIfNeeded:h,filter:u,getTopicExactMatch:m,getUserExactMatch:f,injectedItems:y,items:g,maxEvents:_,maxLists:I,maxTopics:w,onItemClick:v,onItemsChanged:x,orderResults:b,prefetchTypeaheadUsersIfNeeded:C,query:D,shouldDeferPrefetch:E,topicType:R,trustedFriendsId:Z,userLimit:S,...T}=this.props,F=D&&l!==p.ZP.LOADED;let P;return P=F?this.state.shouldShowPrefetchResults&&g.length?g:this._previouslyLoadedResults:g,o.createElement(a.Z,(0,i.Z)({},T,{isLoading:!!F,items:P,onItemClick:this._handleItemClick,query:D,ref:r}))}}N.contextType=m.rC,N.defaultProps={filter:[c.my.Users],injectedItems:[],maxEvents:3,maxLists:3,maxTopics:1};const H=o.forwardRef(((e,t)=>o.createElement(N,(0,i.Z)({},e,{dropdownRef:t})))),A=U.forwardRef(H)},74383:(e,t,s)=>{s.r(t),s.d(t,{TypeaheadInput:()=>Z,default:()=>T,styles:()=>S});var i=s(7896),o=s(2784),n=s(25686),r=s(22150),a=s(35030),l=s(86242),d=s(54044),c=s(73186),h=s(73228),u=s.n(h),p=s(54170),m=s(43779),f=s(99322),y=s(27036),g=s(95254),_=s(52008),I=s(77559),w=s(79075),v=s(88027),x=s(32941),b=s(31261),C=s(45102);const D=u().f065ba8c,E=e=>_.Z.isTwoColumnNormalLayout(e)?{width:y.Z.columnWidths.secondary.normal+c.Z.theme.spacesPx.space24,left:-c.Z.theme.spacesPx.space24/2}:_.Z.isTwoColumnSmallLayout(e)?{width:y.Z.columnWidths.secondary.small+c.Z.theme.spacesPx.space16,left:-c.Z.theme.spacesPx.space16/2}:void 0;let R=1;class Z extends o.Component{constructor(e,t){super(e,t),this._render=({containerWidth:e})=>{const{alwaysOpen:t,disableClearButton:s,forceVdlDisable:l,inputStyle:d,isCompact:c,isOnHomepage:h,placeholder:u,renderCustomInput:m,renderInSearchField:y,rounded:g,shouldAutoFocus:_,shouldFocusOnClear:I,style:w,testID:v}=this.props,x=this.state.showTypeaheadDropdown||t,b={Icon:p.default,ariaActiveDescendant:this.state.ariaDescendantId,ariaAutocomplete:"list",ariaExpanded:x,ariaLabel:D,ariaOwns:this._dropdownDomId,ariaRole:"combobox",autoComplete:"off",autoCorrect:!1,autoFocus:_,contentBelow:y&&y(),focusOnClear:I,isCompact:c,leftAligned:h,onBlur:this._handleInputBlur,onChange:this._handleInputChange,onClear:this._handleInputClear,onFocus:this._handleInputFocus,onLayout:this._handleInputLayoutChanged,placeholder:u,returnKeyType:"search",spellCheck:"false",styleType:l?"legacyPill":g?"pill":"selection",testID:v,value:this.state.query,withClearButton:!s&&this.state.showTypeaheadDropdown};return o.createElement(n.Z,{onLayout:this._handleLayout,ref:this._setRootContainerNode,style:[S.root,w]},o.createElement(a.Z,{onKeyDown:this._handleKeyDown,style:S.keydownInputListener},o.createElement(f.Z,{accessibilityLabel:u,accessibilityRole:"search",onSubmit:this._handleFormSubmit,style:S.wrapper},o.createElement(n.Z,{ref:this._setInputContainerNode,style:d},m?m({...b,handleReturn:this._handleRichTextInputReturn}):o.createElement(r.Z,(0,i.Z)({},b,{ref:this._setInputRef}))),o.createElement(n.Z,{style:[S.typeaheadContainer,!g&&S.topBorder]},x?this._renderDropdown(e):null))))},this._renderDropdown=e=>{const{communityId:t,filter:s,getItemDisabledMessage:i,getItemIsDisabled:n,getTopicExactMatch:r,getUserDisplayNameLabel:a,getUserExactMatch:l,injectedItems:d,isInSidebar:h,isModal:u,isOnHomepage:p,maxEvents:f,maxLists:y,maxTopics:g,onItemsChanged:_,orderResults:w,renderAvatarDecoration:v,renderCallout:b,renderCustomDropdown:D,renderEmptyState:R,renderHeader:Z,renderNoResultsState:T,renderUserDecoration:F,selectedItems:P,shouldDeferPrefetch:L,source:k,trustedFriendsId:U,userLimit:N,withFixedPositioning:H,withSectionDivider:A,withUserHoverCard:M}=this.props,O=(0,m.y)()||e>=c.Z.theme.breakpoints.medium||(0,I.ZP)(),{dropdownOffset:B,query:q}=this.state,z=u?S.modalDropdown:[S.dropdown,!O&&H&&B?[(0,x.xX)(B),{height:`calc(100vh - ${B}px)`}]:null,(O||p)&&S.wideModeDropdown,h&&E(e),p&&S.shortModeDropdown,!O&&p&&S.shortModeDropdownMobile],V={ariaDescendantId:this.state.ariaDescendantId,domId:this._dropdownDomId,onDismiss:this._handleOnEmptyStateDismiss,onItemFocusChanged:this._handleItemFocusChanged,ref:this._handleDropdownRef,style:z},W={ariaDescendantId:this.state.ariaDescendantId,communityId:t,domId:this._dropdownDomId,filter:s,getItemDisabledMessage:i,getItemIsDisabled:n,getTopicExactMatch:r,getUserDisplayNameLabel:a,getUserExactMatch:l,injectedItems:d,maxEvents:f,maxLists:y,maxTopics:g,onItemClick:this._handleItemClick,onItemFocusChanged:this._handleItemFocusChanged,onItemsChanged:_,orderResults:w,query:q,ref:this._handleDropdownRef,renderAvatarDecoration:v,renderCallout:b,renderHeader:Z,renderNoResultsState:T,renderUserDecoration:F,selectedItems:P,shouldDeferPrefetch:L,source:k,style:z,trustedFriendsId:U,userLimit:N,withSectionDivider:A,withUserHoverCard:M};return R&&!q?R(V):D?D(W):o.createElement(C.Z,W)},this._dismissDropdown=()=>{this.setState({showTypeaheadDropdown:!1}),this.props.onDismiss&&this.props.onDismiss()},this._handleOnEmptyStateDismiss=()=>{this._dismissDropdown(),this._inputRef&&this._inputRef.blur()},this._handleLayout=()=>{this._updatePosition()},this._handleInputLayoutChanged=()=>{this._updatePosition()},this._updatePosition=()=>{if(!this._inputContainerNode)return;const{bottom:e}=this._inputContainerNode.getBoundingClientRect();e!==this.state.dropdownOffset&&this.setState({dropdownOffset:e})},this._handleDropdownRef=e=>{this._dropdownRef=e},this._setRootContainerNode=e=>{this._rootContainerNode=e||null},this._setInputRef=e=>{this._inputRef=e,this._activeChildRef||(this._activeChildRef=e)},this._setInputContainerNode=e=>{this._inputContainerNode=e||null,this._inputContainerNode&&this._updatePosition()},this._handleFocusChange=e=>{const t=l.Z.getCount()>0;this._rootContainerNode&&this._rootContainerNode.contains(e.target)||t||this.state.showTypeaheadDropdown&&this._dismissDropdown()},this._handleKeyDown=e=>{const{key:t,shiftKey:s}=e,{alwaysOpen:i}=this.props,{showTypeaheadDropdown:o}=this.state;if((0,x.kE)(e))if(t!==w.Dd){if(this.state.inputHasFocus)return t===w.WX?(this._focusNext(),void e.preventDefault()):t===w.kl?(this._focusPrevious(),void e.preventDefault()):t===w.nQ&&!i&&o?(this._dismissDropdown(),void e.preventDefault()):t===w.NW&&this._hasFocusedItem()?(this._selectFocusedItem(),void e.preventDefault()):void(t!==w.jF&&t!==w.Ci||!this._deleteFocusedItem()?o||this.setState({showTypeaheadDropdown:!0}):e.preventDefault())}else{const t=s&&this._navigatePrevious()||!s&&this._navigateNext();t?(this._activeChildRef=t,e.preventDefault(),t.focus()):this._dismissDropdown()}},this._handleItemFocusChanged=()=>{this.setState({ariaDescendantId:(0,x.A1)()})},this._handleInputClear=()=>{this.setQuery("")},this._handleInputBlur=()=>{this.setState({inputHasFocus:!1}),this.props.onBlur&&this.props.onBlur()},this._handleInputFocus=()=>{this._activeChildRef=this._inputRef,this.setState({inputHasFocus:!0,showTypeaheadDropdown:!0}),this._updatePosition(),this.props.onFocus&&this.props.onFocus()},this._handleRichTextInputReturn=e=>e.shiftKey?"not-handled":(this._hasFocusedItem()||this._handleFormSubmit(e),"handled"),this._handleInputChange=e=>{this.setQuery(e.target.value),this._updatePosition()},this._handleFormSubmit=e=>{e.preventDefault(),e.stopPropagation(),this._inputRef&&this._inputRef.blur(),this.setState({showTypeaheadDropdown:!1}),this.props.onDismiss&&this.props.onDismiss(),this.props.onSubmit&&this.props.onSubmit()},this._handleItemClick=(e,t)=>{const{onDismiss:s,onItemClick:i,shouldClearOnSelect:o,shouldFocusOnClear:n}=this.props,r=o?"":this.state.query;this.setState({showTypeaheadDropdown:!1}),this._inputRef&&(o&&n?this._inputRef.focus():this._inputRef.blur()),this.setQuery(r),s&&s(),i&&i(e,t)},this._hasFocusedItem=()=>this._dropdownRef&&this._dropdownRef.hasFocusedItem(),this._deleteFocusedItem=()=>!!(this._dropdownRef&&this._dropdownRef.deleteFocusedItem&&this._dropdownRef.hasFocusedItem()&&this._dropdownRef.deleteFocusedItem()),this._selectFocusedItem=()=>{this._dropdownRef&&this._dropdownRef.selectFocusedItem()},this._focusNext=()=>{this._dropdownRef&&this._dropdownRef.focusNext()},this._focusPrevious=()=>{this._dropdownRef&&this._dropdownRef.focusPrevious()},this._navigateNext=()=>{if(this._dropdownRef&&this._dropdownRef.navigateNext)return this._dropdownRef.navigateNext()},this._navigatePrevious=()=>{if(!this.state.inputHasFocus&&this._dropdownRef&&this._dropdownRef.navigatePrevious)return this._dropdownRef.navigatePrevious()||this._inputRef},this.state={ariaDescendantId:(0,x.A1)(),inputHasFocus:!1,query:e.initialValue,showTypeaheadDropdown:!1},this._dropdownDomId=`typeaheadDropdown-${R}`,R+=1}componentDidUpdate(e){this.props.initialValue!==e.initialValue&&this.setQuery(this.props.initialValue)}componentDidMount(){window.document.addEventListener("click",this._handleFocusChange,!0)}componentWillUnmount(){window.document.removeEventListener("click",this._handleFocusChange,!0)}render(){return o.createElement(d.Z,null,this._render)}focus(){this._activeChildRef&&this._activeChildRef.focus()}setQuery(e){this.setState({query:e}),this.props.onQueryChange&&this.props.onQueryChange(e)}}Z.defaultProps={disableClearButton:!1,filter:[v.my.Users,v.my.Topics],isInSidebar:!1,initialValue:"",withSectionDivider:!0,withUserHoverCard:!1},Z.contextType=b.rC;const S=c.Z.create((e=>({root:{flex:1,flexDirection:"column",position:"relative",zIndex:g.R0+1},typeaheadContainer:{flex:1,position:"relative"},keydownInputListener:{flexShrink:1,width:"100%"},dropdown:{backgroundColor:e.colors.cellBackground,start:0,end:0,overflowY:"auto",overscrollBehavior:"contain",position:"absolute",top:0,WebkitOverflowScrolling:"touch"},modalDropdown:{backgroundColor:e.colors.cellBackground,flex:1,minHeight:300,position:"relative",overflowY:"auto",overscrollBehavior:"auto",WebkitOverflowScrolling:"touch"},wideModeDropdown:{borderRadius:e.borderRadii.medium,boxShadow:e.boxShadows.medium,minHeight:100,maxHeight:`calc(80vh - ${e.componentDimensions.appBarHeight})`},shortModeDropdown:{minHeight:100,maxHeight:"35vh",paddingBottom:"0"},shortModeDropdownMobile:{position:"absolute",height:"40vh",top:0},wrapper:{alignItems:"stretch",flex:1},topBorder:{borderTopColor:e.colors.gray200,borderTopStyle:"solid",borderTopWidth:e.borderWidths.small}}))),T=Z},30084:(e,t,s)=>{s.d(t,{Z:()=>l});var i=s(2784),o=s(25686),n=s(35953),r=s(36934),a=s(44329);function l(e){const{image:t,style:s,supportText:l,title:c}=e;return i.createElement(o.Z,{style:[d.root,s]},i.createElement(o.Z,{style:[d.coverContainer,d.largeCellThumbnail]},t?i.createElement(n.Z,{accessibilityLabel:"",aspectMode:a.Z.SQUARE,image:t}):null),i.createElement(o.Z,{style:d.bodyColumn},l?i.createElement(r.ZP,{color:"gray700",numberOfLines:1,size:"subtext2"},l):null,i.createElement(r.ZP,{numberOfLines:2,weight:"bold"},c)))}const d=s(73186).Z.create((e=>({root:{flexDirection:"row",flexShrink:1,flexGrow:1},bodyColumn:{justifyContent:"center",flexDirection:"column",marginEnd:e.spaces.space4,marginStart:e.spaces.space12,flexShrink:1},coverContainer:{borderRadius:e.borderRadii.large,overflow:"hidden"},cellThumbnail:{height:e.spaces.space48,width:e.spaces.space48},largeCellThumbnail:{height:e.spaces.space56,width:e.spaces.space56}})))},19051:(e,t,s)=>{s.d(t,{ib:()=>ne,ZP:()=>se});s(6886);var i=s(2784),o=s(25686),n=s(36934),r=s(74062),a=s(73186),l=s(7066),d=s(33363),c=s(88027),h=s(31261),u=s(37541),p=s(23837),m=s(41266),f=s(84515),y=s(92160),g=s(92157),_=s(57659);const I=(e,t)=>t.conversationId,w=(e,t)=>(0,g.x)(e,I(0,t)),v=(0,y.Z)().propsFromState((()=>({conversationId:I,conversation:w,users:_.ZP.selectAll}))).adjustStateProps((({conversation:e,conversationId:t,users:s})=>{const i={conversation:void 0};return null!=e&&e.data&&(i.conversation=(0,f.E5)(e.data,void 0,s)),i})),x=a.Z.create((e=>({root:{cursor:"pointer",paddingHorizontal:e.componentDimensions.gutterHorizontal,paddingVertical:e.componentDimensions.gutterVertical,width:"100%"},avatarColumn:{flexGrow:1,maxWidth:e.spaces.space40,minWidth:"32px"},bodyColumn:{flexGrow:7,alignItems:"center",flexDirection:"row",justifyContent:"space-between"},disabled:{opacity:.6,backgroundColor:e.colors.gray0}}))),b=v((({conversation:e,isDisabled:t,isSelected:s,perspective:o})=>e?i.createElement(u.Z,{avatarCell:i.createElement(p.Z,{conversation:e,perspective:o,size:"xLarge"}),avatarCellStyle:x.avatarColumn,avatarSize:"xLarge",cellStyle:x.bodyColumn,style:[x.root,!s&&t&&x.disabled]},i.createElement(m.Z,{conversation:e,perspective:o,withParticipantsCount:!0}),ne({isSelected:s})):null));var C=s(30084),D=s(35953),E=s(44329),R=s(37800),Z=s(3613);function S(e){return i.createElement(o.Z,{style:T.container},i.createElement(o.Z,{style:T.imageContainer},i.createElement(D.Z,{accessibilityLabel:"",aspectMode:E.Z.SQUARE,image:e.image})),i.createElement(o.Z,{style:T.bodyContainer},i.createElement(Z.Z,null,i.createElement(n.ZP,{size:"body",weight:"bold"},e.name),i.createElement(n.ZP,{color:"gray700",size:"subtext2"},e.secondaryContext)),i.createElement(o.Z,{style:T.row},i.createElement(R.Z,{style:T.facepile,userAvatarSize:"small",userAvatarUrls:e.facepileUrls,withIncreasedSpacing:!0}),i.createElement(n.ZP,{color:"gray700",size:"subtext2"},e.primaryContext))))}const T=a.Z.create((e=>({bodyContainer:{flexGrow:1},container:{flexDirection:"row",paddingHorizontal:e.spaces.space16,paddingVertical:e.spaces.space12},facepile:{marginEnd:e.spaces.space4},imageContainer:{borderRadius:e.borderRadii.medium,height:e.spaces.space40,marginEnd:e.spaces.space12,overflow:"hidden",width:e.spaces.space40},row:{flexDirection:"row"}})));var F=s(96847),P=s(38749),L=s(10891),k=s(80166),U=(s(53985),s(36728),s(85940),s(35903)),N=s.n(U);const H=a.Z.create((e=>({root:{paddingHorizontal:e.componentDimensions.gutterHorizontal,paddingVertical:e.spaces.space16},context:{alignItems:"center",flexDirection:"row"},icon:{color:e.colors.primary,height:e.fontSizes.subtext2,paddingEnd:e.spaces.space4,width:e.fontSizes.subtext2},disabled:{backgroundColor:e.colors.gray0},searchIcon:{marginEnd:e.spaces.space12,borderWidth:0,backgroundColor:"none"},searchIconCell:{flexDirection:"row",alignItems:"center"},wrapperCellStyle:{justifyContent:"center"}}))),A=function(e){const{isDisabled:t,query:s,resultContext:r,showIcon:a,style:l,topic:d}=e,c=function(e,t){const s=N()(e),i=e.toLowerCase().indexOf(t.toLowerCase()),o=i+t.length;let n;if(0===s.length){const t=[i>0?[0,i]:void 0,[o,e.length]].filter(Boolean);n=[{highlights:-1!==i?t:void 0,text:e,entityType:"text",prefix:"",indices:[0,e.length]}]}else{const t=s.flatMap((({indices:t},s,i)=>{const o=0===s?0:i[s-1].indices[1],n=s===i.length-1,r=[];return o!==t[0]&&r.push(e.slice(o,t[0])),r.push(e.substring(t[0],t[1])),n&&e.length!==t[1]&&r.push(e.slice(t[1])),r}));let r=0;const a=t.map(((e,t,s)=>{r+=t>0?s[t-1].length:0;const n=e.length;return{runningTotal:r,containsQuery:-1!==i&&r+n>=i&&r<o}}));n=t.map(((e,t)=>{var s;const{containsQuery:n,runningTotal:r}=a[t],l=e.includes("#");let d,c;if(n){if(n){let t=r<i?i-r:0,s=r+e.length<o?e.length:o-r;l&&(t-=1,s-=1),d=[],t>0&&d.push([0,t]),s!==e.length-1&&d.push([s,e.length])}}else d=[[0,e.length]];return null!=(s=d)&&s.length&&(c=d),l?{highlights:c,text:`${null==e?void 0:e.replace("#","")}`,entityType:"hashtag",prefix:"#",indices:[r,r+e.length]}:{highlights:c,text:e,entityType:"text",prefix:"",indices:[r,r+e.length]}}))}return n}(d,s),h=i.createElement(n.ZP,null,c.map(((e,t)=>i.createElement(F.ZP,{key:`${e.text}${t}`,part:e})))),p="xxxLarge",m=i.createElement(i.Fragment,null,h,r?i.createElement(o.Z,{style:H.context},r&&r.types[0]&&"followable_topic"===r.types[0].type?i.createElement(k.default,{style:H.icon}):null,i.createElement(n.ZP,{color:"gray700"},r.display_string||" ")):null);return i.createElement(o.Z,{style:[H.root,t&&H.disabled,l]},a?(e=>{const t=i.createElement(P.Z,{Icon:L.default,color:"neutral",size:p,style:H.searchIcon});return i.createElement(u.Z,{avatarCell:t,avatarCellStyle:H.searchIconCell,avatarSize:p,cellStyle:H.wrapperCellStyle},e)})(m):m)};var M=s(54044),O=s(19153),B=s(73228),q=s.n(B),z=s(35210),V=s(86928);const W=(e,t)=>(0,V.cY)(e,t.userId),j=(0,y.Z)().propsFromState((()=>({userSpace:W}))),Q="TypeaheadUser",G=q().ae2205d2,$=q().d960b55c,Y=q().fd06b02f,K=Object.freeze({num_of_followers:z.Z.Follow,bio:z.Z.TextOnly,location:z.Z.Location,num_tweets:z.Z.NewTweets,follow_relationship:z.Z.Follow,followers_follow:z.Z.Follow,social_proof:z.Z.SocialProof,follow_relationship_mutual_follow:z.Z.FollowMutual,follow_relationship_followed:z.Z.FollowFollowed,follow_relationship_following:z.Z.FollowFollowing,highlighted_label:"HighlightedIcon"});class X extends i.PureComponent{constructor(...e){super(...e),this._handleAvatarClick=()=>{const{userSpace:e}=this.props;e||this._handleClick()},this._handleClick=()=>{const{isDisabled:e,item:t,onItemClick:s}=this.props;s&&s(t,!!e)}}render(){const{affiliateBadgeInfo:e,avatarDecoration:t,avatarUri:s,decoration:o,disabledMessage:n,displayNameLabel:r,isBlueVerified:l,isDisabled:d,isProtected:h,isVerified:u,name:p,screenName:m,source:f,userId:y,userSpace:g,verifiedType:_,withHoverCard:I}=this.props,{featureSwitches:w}=this.context,{context:v,highlightedLabel:x}=this._getItemContext(),b=f===c._4.SearchBox,C=g&&w.isTrue("voice_rooms_typeahead_audiospace_ring_enabled")?g:void 0;return C&&(C.accessibilityLabel=Y({screenName:m})),i.createElement(M.Z,null,(({windowWidth:c})=>{const f=c>a.Z.theme.breakpoints.small?"xxxLarge":"xxLarge";return i.createElement(O.ZP,{affiliateBadgeInfo:e,avatarDecoration:t,avatarSize:f,avatarUri:s,decoration:o,disabledMessage:d?n:void 0,displayMode:"ExperimentalUserTypeahead",displayNameLabel:r,highlightedLabel:x,isBlueVerified:l,isDisabled:d,isProtected:h,isVerified:u,name:p,onAvatarClick:this._handleAvatarClick,onCellClick:this._handleClick,onScreenNameClick:this._handleClick,presenceIndicator:b?C:void 0,screenName:m,socialContext:v,testID:Q,userId:y,verifiedType:_,withInteractiveStyling:!1,withLink:I})}))}_getItemContext(){const e=this._getResultContext();return{highlightedLabel:null==e?void 0:e.highlightedLabel,context:null!=e&&e.highlightedLabel?void 0:e||this._getSocialContext()}}_getSocialContext(){const{socialContext:e}=this.props;if(!e||!e.following)return;const t=e.followed_by?G:$;return{contextType:z.Z.Follow,text:t}}_getResultContext(){const{resultContext:e}=this.props;if(!e||!e.display_string||!e.types)return;const{display_string:t,icon_url:s,types:i}=e,o=i.length?i[0].type:void 0,n=o&&o in K?K[o]:z.Z.TextOnly;return{contextType:n,text:t,highlightedLabel:n===K.highlighted_label&&s?{badge:{url:s},description:t}:void 0}}}X.contextType=h.rC,X.defaultProps={withHoverCard:!1};const J=j.forwardRef(X),ee="typeaheadResult",te=({children:e})=>e;function se(e){return i.createElement(te,{item:e.item},i.createElement(ie,e))}class ie extends i.Component{constructor(...e){super(...e),this._onViewRef=e=>{this._viewRef=e;const{onRef:t}=this.props;t&&t(e)},this._handleClick=()=>{const{item:e}=this.props;e.type!==c.El.User&&this.props.onClick&&this.props.onClick(e,this.isDisabled)}}componentDidMount(){this._loaded=!0,this._viewRef&&(this._rafId=window.requestAnimationFrame((()=>{this._viewRef&&this._viewRef.setNativeProps({style:{opacity:1}})})))}componentDidUpdate(e){const{onRef:t}=this.props;t&&t!==e.onRef&&this._viewRef&&t(this._viewRef)}componentWillUnmount(){this._rafId&&window.cancelAnimationFrame(this._rafId)}render(){const{domId:e,isDisabled:t,isFocused:s,isInMultiSelect:n,isSelected:a,style:l}=this.props;return i.createElement(o.Z,{accessibilityChecked:!(!n||!a)||void 0,accessibilityRole:"option",accessibilitySelected:t?void 0:n&&a||!n&&!!s,nativeID:e,testID:ee},i.createElement(r.Z,{accessibilityRole:n?"checkbox":"button",disabled:t,focusable:!0,onPress:this._handleClick,style:[s&&oe.focused,oe.transitionStyles,this._loaded&&oe.loaded,l],viewRef:this._onViewRef},this._renderResult()))}_renderResult(){const{disabledMessage:e,getUserDisplayNameLabel:t,isDisabled:s,isSelected:r,item:a,onClick:l,renderAvatarDecoration:h,renderUserDecoration:u,source:p,withUserHoverCard:m}=this.props;switch(a.type){case c.El.DMConversation:return!!this.context.viewerUserId&&i.createElement(b,{conversationId:a.id,isDisabled:s,isSelected:r,perspective:this.context.viewerUserId});case c.El.Event:{const{data:e}=a;return i.createElement(C.Z,{image:e.primary_image&&e.primary_image.original_info,style:oe.itemPadding,supportText:e.supporting_text,title:e.topic})}case c.El.Hashtag:case c.El.Topic:{const{query:e}=this.props,{data:t}=a,o=p===c._4.SearchBox;return i.createElement(A,{isDisabled:s,query:e||"",resultContext:t.result_context,showIcon:o,style:o?oe.itemPadding:void 0,topic:t.topic})}case c.El.List:{const e=a.data.facepile_urls,t=a.data.primary_image.original_info,s=a.data.topic,o=a.data.result_contexts[0].result_context.display_string,n=a.data.result_contexts[1].result_context.display_string;return i.createElement(S,{facepileUrls:e,image:t,name:s,primaryContext:o,secondaryContext:n})}case c.El.SettingGroup:{const{text:e}=a.data;return i.createElement(o.Z,{style:oe.navigationLink},i.createElement(n.ZP,{style:oe.content,weight:"bold"},e),i.createElement(d.default,{style:oe.icon}))}case c.El.Setting:{const{text:e}=a.data;return i.createElement(o.Z,{style:oe.navigationLink},i.createElement(n.ZP,{style:oe.content},e),i.createElement(d.default,{style:oe.icon}))}case c.El.NoResult:{const{data:e}=a,{text:t}=e;return i.createElement(n.ZP,{style:oe.noResult},t)}case c.El.User:{const{data:o}=a,n=null==h?void 0:h(),d=u?u({userId:o.id_str,user:o,isSelected:r}):void 0,c=t?t(a,o):void 0;return i.createElement(J,{affiliateBadgeInfo:o.highlightedLabel,avatarDecoration:n||void 0,avatarUri:o.profile_image_url_https,canDm:!!o.can_dm,canMediaTag:!!o.can_media_tag,decoration:d||void 0,disabledMessage:e,displayNameLabel:c,isBlueVerified:o.is_blue_verified,isDisabled:s,isProtected:!!o.protected,isVerified:!!o.verified,item:a,name:o.name,onItemClick:l,resultContext:o.result_context,screenName:o.screen_name,socialContext:o.social_context,source:p,userId:o.id_str,verifiedType:o.verified_type,withHoverCard:m})}default:return null}}get isDisabled(){return!!this.props.isDisabled}}ie.contextType=h.rC;const oe=a.Z.create((e=>({checkIcon:{color:e.colors.primary},navigationLink:{alignItems:"center",flexDirection:"row",flexGrow:1,paddingHorizontal:e.componentDimensions.gutterHorizontal,paddingVertical:e.spaces.space16},content:{flexGrow:1,flexShrink:1},icon:{color:e.colors.gray700,paddingStart:e.spaces.space12,flexShrink:0},noResult:{paddingHorizontal:e.componentDimensions.gutterHorizontal,paddingVertical:e.spaces.space16},itemPadding:{paddingHorizontal:e.componentDimensions.gutterHorizontal,paddingVertical:e.componentDimensions.gutterVertical},loaded:{opacity:1},focused:{backgroundColor:e.colors.gray0},transitionStyles:{transitionProperty:"opacity",transitionDuration:"250ms",opacity:0}}))),ne=({isSelected:e})=>e?i.createElement(l.default,{accessibilityHidden:!0,style:oe.checkIcon}):null},6800:(e,t,s)=>{s.d(t,{o:()=>o});var i=s(16742);const o=(0,i.Z)([]);(0,i.Z)({})},79075:(e,t,s)=>{s.d(t,{Ci:()=>c,Dd:()=>l,NW:()=>n,Ur:()=>a,WX:()=>i,jF:()=>d,kl:()=>o,nQ:()=>r});const i="ArrowDown",o="ArrowUp",n="Enter",r="Escape",a="ESC",l="Tab",d="Delete",c="Backspace"},92157:(e,t,s)=>{s.d(t,{x:()=>o});var i=s(34562);const o=(e,t)=>e[i.Yf]?e[i.Yf].conversations[t]:null},10891:(e,t,s)=>{s.r(t),s.d(t,{default:()=>a});var i=s(2784),o=s(90601),n=s(73569);const r=(e={})=>(0,o.Z)("svg",{...e,accessibilityRole:e.accessibilityLabel?e.accessibilityRole||"img":void 0,accessibilityHidden:void 0===e.accessibilityLabel,style:[n.Z.root,e.style],viewBox:"0 0 21 21",children:i.createElement("g",null,i.createElement("path",{d:"M9.094 3.095c-3.314 0-6 2.686-6 6s2.686 6 6 6c1.657 0 3.155-.67 4.243-1.757 1.087-1.088 1.757-2.586 1.757-4.243 0-3.314-2.686-6-6-6zm-9 6c0-4.971 4.029-9 9-9s9 4.029 9 9c0 1.943-.617 3.744-1.664 5.215l4.475 4.474-2.122 2.122-4.474-4.475c-1.471 1.047-3.272 1.664-5.215 1.664-4.97-.001-8.999-4.03-9-9z"}))});r.metadata={width:21,height:21};const a=r}}]);
//# sourceMappingURL=https://ton.local.twitter.com/responsive-web-internal/sourcemaps/client-web/shared~loader.Typeahead~bundle.Communities~bundle.Delegate~bundle.Ocf~bundle.LoggedOutHome~bundle.Search~bund.180219aa.js.map